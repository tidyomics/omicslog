---
title: "EXPERIMENTAL: Getting Started with omicslog"
output: BiocStyle::html_document
vignette: >
  %\VignetteIndexEntry{EXPERIMENTAL: Getting Started with omicslog}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
knit: >
    (function(x, ...){
        proj_root <- rprojroot::find_package_root_file() |> normalizePath()
        rmarkdown::render(
            x,
            output_format = "html_document",
            params = list(
                demo_metadata = TRUE
            )
        )
        rmarkdown::render(
            x,
            output_file = "README.md",
            output_format = "github_document",
            output_dir = proj_root,
            knit_root_dir = proj_root,
            params = list(
                demo_metadata = FALSE
            )
        )
    })
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  message = TRUE,
  warning = TRUE
)
```

# Introduction

> **WARNING**: This package is EXPERIMENTAL and under active development. APIs and functionality may change without notice.

```{r setup, message=FALSE}
library(SummarizedExperiment)
library(tidySummarizedExperiment)
library(omicslog)
data(airway, package="airway")
```

The `omicslog` package provides logging capabilities for `SummarizedExperiment` objects. 
This is particularly useful for tracking transformations in complex analysis workflows.

## Pipeline Workflow

Alternatively, you can chain these operations into a single pipeline:

```{r, message=TRUE, warning=TRUE}
# Complete workflow in a single pipeline
result <- 
  airway |>
  log_start() |>
  filter(dex == "untrt") |>
  mutate(dex_upper = toupper(dex)) |>
  mutate(Run = tolower(Run)) |> 
  filter(.feature == "ENSG00000000003")

# View the object with its complete log history
result
```

## Base R Subsetting

You can also use base R subsetting operations, which will be logged automatically:

```{r}
# Create a logged object
se_logged <- airway |>
  log_start()

# Subset genes (rows)
result_genes <- se_logged[1:10, ]
result_genes

# Subset samples (columns)
result_samples <- se_logged[, colData(se_logged)$dex == "untrt"]
result_samples

# Combined subsetting
result_combined <- se_logged[1:5, colData(se_logged)$dex == "untrt"]
result_combined
```


## Base R Metadata Modifications

The package also supports logging of base R metadata modifications. This includes operations like adding or modifying columns in the `colData`:

```{r, message=TRUE, warning=TRUE}
# Start with a logged object
se_logged <- log_start(airway)

# Add a new column to colData
colData(se_logged)$new_column <- rep("test", ncol(se_logged))

# Modify an existing column
colData(se_logged)$dex <- tolower(colData(se_logged)$dex)

# View the object to see the log history
se_logged
```

The log will show:
- When new columns are added
- When existing columns are modified
- The timestamp of each operation

This is particularly useful when you need to:
- Add custom annotations to your samples
- Modify existing metadata
- Track changes made to the object's structure

# Session Info

```{r}
sessionInfo()
``` 